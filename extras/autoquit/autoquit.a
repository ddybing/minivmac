;	autoquit.a
;
;	Copyright (C) 2002 Paul Pratt
;
;	You can redistribute this file and/or modify it under the terms
;	of version 2 of the GNU General Public License as published by
;	the Free Software Foundation.  You should have received a copy
;	of the license along with this file; see the file COPYING.
;
;	This file is distributed in the hope that it will be useful,
;	but WITHOUT ANY WARRANTY; without even the implied warranty of
;	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;	license for more details.

; Assembly language version of the following C code:
;
;	#define kDSK_Block_Base 0x00F40000
;	#define kDSK_QuitOnEject 3
;
;	void main(void)
;	{
;		MaxApplZone();
;		InitGraf((Ptr)&qd.thePort);
;		InitFonts();
;		InitWindows();
;		InitMenus();
;		TEInit();
;		InitDialogs(NULL);
;		((short *)kDSK_Block_Base)[kDSK_QuitOnEject] = 1;
;		ShutDwnPower();
;	}
;
; Using assembly language allows a smaller executable.

		_MaxApplZone: OPWORD $A063
		_InitGraf: OPWORD $A86E
		_InitFonts: OPWORD $A8FE
		_InitWindows: OPWORD $A912
		_InitMenus: OPWORD $A930
		_TEInit: OPWORD $A9CC
		_InitDialogs: OPWORD $A97B
		_ShutDown: OPWORD $A895

autoquit MAIN EXPORT

		LINK       A6, #-$0400
		_MaxApplZone
		PEA        -$0200(A6)
; I think the quickdraw variables are a bit over 200 bytes.
; left some space on either side just in case.
		_InitGraf
		_InitFonts
		_InitWindows
		_InitMenus
		_TEInit
		CLR.L      -(A7)
		_InitDialogs
		MOVEA.L    #$00F40006,A0
		MOVE.W     #$01, (A0)
		MOVE.W     #$0001, -(A7)
		_ShutDown
		UNLK       A6
		RTS

		ENDMAIN

		END
